[
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Welcome!",
    "section": "",
    "text": "Welcome to my personal website! My name is Jianing Yao. I am a first-year Biostatistics PhD student at Johns Hopkins Bloomberg School of Public Health."
  },
  {
    "objectID": "about.html",
    "href": "about.html",
    "title": "About",
    "section": "",
    "text": "My name is Jianing Yao. I am a first-year Ph.D. student at the Department of Biostatistics at Johns Hopkins Bloomberg School of Public Health (JHSPH). I am currently working with Dr. Stephanie Hicks on statistical and computational genomics. My focus is on the development of methods driven by specific problems, as well as open-source software tools to facilitate research in these areas.\n\nEducational background\n\nJohns Hopkins Bloomberg School of Public Health (JHSPH)\n\nPh.D. student, Biostatistics (2023 - Current)\nMaster of Science, Biostatistics (2021 - 2023)\n\nUniversity of Southern California (USC)\n\nBachelor of Science, Applied and Computational Math (2016 - 2020)\nBachelor of Arts, Psychology (2016 - 2020)\n\n\n\n\nProfessional background/experience\n\nSpatial domain detection in spatial transcriptomics using GNN\n\nAdvised by Dr. Stephanie Hicks, JHSPH\n\nAncestry inference from single-cell RNA-seq data\n\nAdvised by Dr. Steven Gazal, USC\n\nLongitudinal twin data analysis to investigate genetic association between child aggression and parenting\n\nAdvised by Dr. Laura Baker, USC\n\n\n\n\nResearch interests\n\nDeveloping scalable clustering methods and software for spatial omics data."
  },
  {
    "objectID": "analysis.html",
    "href": "analysis.html",
    "title": "Example analysis",
    "section": "",
    "text": "Background:\nHealthcare costs for employed women in the United States are estimated to be $15 billion greater than for employed men from the age of 19 to 64 in 2023, according to research by Deloitte (Closing the Benefit Gap to Advance Women’s Health Equity 2023). This economic strain contributes to the existing pay gap between genders and continues even when services related to maternity are not considered. What about elderly people above 65 years old who are more likely to face severe and chronic diseases? Will the disparity persist, or even exaggerate, for older man and women?\n\n\n\nFigure 1: Healthcare benefit gap in 2023\n\n\n\n\nQuestion:\nFor this analysis, I am interested in the question of whether older (at least 65 years of age) men and women of the same age use roughly the same quantity of medical services measured by their annual medical expenditures.\n\n\nAudience:\nThis analysis can help healthcare policymakes to better understand how medical needs and expenses differ by gender among the elderly so that they can tailor more effective and equitable healthcare policies.\n\n\nDataset:\nThe data of annual medical expenditures for men and women from 65 to 95 years of age were obtained and adjusted from the 1987 National Medical Expenditure Survey (Scientific Data NMES 2016). To answer the research question above, I used three variables extracted from the data set: participant’s age (lastage), gender (female), and total health care expenditures (totalexp). A full list of data dictionary can be found here.\n\n\n\n\n\n\nNote\n\n\n\nThe data and analysis are adopted from homework of Methods in Biostatistics.\n\n\n\n\nAnalysis:\n\nStep 0: data set preparation.\nSelect variables of interest (i.e., age, gender, medical expenditures) and create variables for linear spline with knots at 75 and 85 years of age.\n\n\nCode\nlibrary(dplyr)\nload(\"./data/nmes.rdata\")\nd &lt;- nmes %&gt;%\n  select(names(.)[c(2,3,15)]) %&gt;%\n  filter(., lastage&gt;=65) %&gt;%\n  mutate(agem65 = lastage - 65,\n         age_sp1 = ifelse(lastage-75&gt;0, lastage - 75, 0),\n         age_sp2 = ifelse(lastage-85&gt;0, lastage - 85, 0),\n         Gender = factor(ifelse(male == 0, 1, 0)))\nd$Gender &lt;- factor(d$Gender,levels=c(0,1),labels=c(\"Male\",\"Female\"))\nd &lt;- d[complete.cases(d),]\nd &lt;- d[order(d$lastage),]\n\n\n\n\nStep 1: exploratory analysis\nCompute mean and standard deviation for age and medical expenditures for female and male.\n\n\nCode\nlibrary(knitr)\nlibrary(kableExtra)\n\nsummary &lt;- d %&gt;% \n  group_by(Gender) %&gt;%\n  summarise(mean_age = mean(lastage), \n            sd_age = sd(lastage),\n            mean_exp = mean(totalexp),\n            sd_exp = sd(totalexp)) %&gt;%\n  ungroup()\n\ncolnames(summary) &lt;- c('Gender', 'Age mean', 'Age sd', 'Expenditure mean', 'Expenditure sd')\nsummary_table &lt;- kable(summary, format = \"html\", table.attr = \"class='table table-striped'\") %&gt;%\n  kable_styling(bootstrap_options = c(\"striped\", \"hover\", \"condensed\", \"responsive\"))\n\nsummary_table\n\n\n\n\n\n\nGender\nAge mean\nAge sd\nExpenditure mean\nExpenditure sd\n\n\n\n\nMale\n73.36447\n6.318776\n4468.722\n10951.53\n\n\nFemale\n74.04232\n6.794712\n4366.424\n10327.56\n\n\n\n\n\n\n\n\n\n\nCode\nlibrary(ggplot2)\nggplot(data = d, aes(x = lastage, y = totalexp / 1000, color = Gender)) +\n  geom_point() +\n  facet_wrap(~ Gender) +\n  labs(x = \"Age (in years)\", y = \"Medical Expenditure (in $1000s)\", title = \"Medical Expenditures (in $1000s) by Gender\") +\n  scale_y_continuous(breaks=seq(0,200,20),limits=c(0,200)) +\n  scale_x_continuous(breaks=seq(65,95,5), limits=c(65,95)) +\n  theme_bw()\n\n\n\n\n\nFigure 2: Medical expenditures in thousands of dollars by gender for participants above 65 years old.\n\n\n\n\n\n\nStep 2: linear regression model with age and gender\nFirst, we fit a full linear regression model with age, linear splines with knots at 75 and 85 years of age, gender, and interactions between predictors.\nGeneral MLR model:\n\\[\n\\begin{align*}\nY_i = & \\ \\beta_0 + \\beta_1(age_i-65) + \\beta_2(age_i-75)^+ + \\beta_3(age_i-85)^+ \\\\\n      & + \\beta_4\\text{female}_i + \\beta_5\\text{female}_i \\cdot (age_i-65) \\\\\n      & + \\beta_6\\text{female}_i \\cdot (age_i-75)^+ + \\beta_7\\text{female}_i \\cdot (age_i-85)^+ + \\epsilon_i \\text{ , } \\\\\n      & \\ \\text{where } \\epsilon_i \\sim N(0, \\sigma^2)\n\\end{align*}\n\\]\n\n\n\n\n\n\nModel Assumption\n\n\n\nNote that constant variance (homoscedasticity) is assumed in this linear regression model.\n\n\n\n\nCode\nlibrary(broom)\n\nmlr.fit &lt;- lm(totalexp ~ (agem65 + age_sp1 + age_sp2) + Gender + Gender*(agem65 + age_sp1 + age_sp2), data = d)\n\ntidy_mlr.fit &lt;- tidy(mlr.fit)\ntidy_mlr.fit &lt;- tidy_mlr.fit[, c(\"term\", \"estimate\", \"std.error\", \"statistic\", \"p.value\")]\n\nkable(tidy_mlr.fit, caption = \"Linear model coefficients of the full model\", digits = 3, format = \"html\", \n      col.names = c(\"Term\", \"Estimate\", \"Std. Error\", \"t value\", \"Pr(&gt;|t|)\")) %&gt;%\n  kable_styling(bootstrap_options = c(\"striped\", \"hover\"), full_width = F, position = \"left\")\n\n\n\nLinear model coefficients of the full model\n\n\nTerm\nEstimate\nStd. Error\nt value\nPr(&gt;|t|)\n\n\n\n\n(Intercept)\n4159.387\n473.406\n8.786\n0.000\n\n\nagem65\n11.857\n75.829\n0.156\n0.876\n\n\nage_sp1\n132.811\n153.871\n0.863\n0.388\n\n\nage_sp2\n-254.602\n327.083\n-0.778\n0.436\n\n\nGenderFemale\n-974.517\n614.701\n-1.585\n0.113\n\n\nagem65:GenderFemale\n117.222\n98.182\n1.194\n0.233\n\n\nage_sp1:GenderFemale\n-154.604\n197.009\n-0.785\n0.433\n\n\nage_sp2:GenderFemale\n512.462\n406.299\n1.261\n0.207\n\n\n\n\n\n\n\n\n\n\nagem65: age after centered at 65\nage_sp1: the number of years if a person is over 75; if not, age_sp1 = 0\nage_sp2: the number of years if a person is over 85; if not, age_sp2 = 0\nGenderFemale: indicator of female\n\n\n\nCode\nd$observed_y = d$totalexp / 1000\nd$predicted_y = mlr.fit$fitted.values / 1000\nggplot(d, aes(x = lastage, y = observed_y, color=Gender)) +\n    geom_jitter(alpha = 0.7, size = 0.6) + # use jittered points for better visualization \n    geom_line(aes(x = lastage, y = predicted_y)) +\n    scale_y_continuous(breaks=seq(0,200,20),limits=c(0,200)) +\n    scale_x_continuous(breaks=seq(65,95,5),limits=c(65,95)) +\n    labs(x = \"Age (in years)\", y = \"Medical Expenditure (in $1000s)\", title = \"Medical Expenditures (in $1000s) by Age and Gender with fitted line\") +\n    theme_bw()\n\n\n\n\n\nFigure 3: Medical expenditures in thousands of dollars by gender for participants above 65 years old, with the fitted lines estimated from the full linear regression model.\n\n\n\n\n\n\ngeom_jitter to plot jittered points for better visualization\nZoom in on the plot to show the average medical expenditures for females and males across age.\n\n\nCode\nggplot(d, aes(x = lastage, y = observed_y, color=Gender)) +\n    geom_jitter(alpha = 0.5, size = 0.6) +\n    geom_line(aes(x = lastage, y = predicted_y)) +\n    scale_y_continuous(breaks=seq(0,15,5),limits=c(0,15)) +\n    scale_x_continuous(breaks=seq(65,95,5),limits=c(65,95)) +\n    labs(x = \"Age (in years)\", y = \"Medical Expenditure (in $1000s)\", title = \"Medical Expenditures (in $1000s) by Age and Gender with fitted line\") +\n    theme_bw()\n\n\n\n\n\nFigure 4: Zoomed in plot of medical expenditures in thousands of dollars by gender for participants above 65 years old, with the fitted lines estimated from the full linear regression model.\n\n\n\n\nPlot expected difference between women and men in expenditures as a function of age.\n\n\nCode\nage = seq(65,95)\nagesp1 = ifelse(age&gt;=75,age-75,0)\nagesp2 = ifelse(age&gt;=85,age-85,0)\nage65 = age-65\nAGE = rbind(rep(1,31),age65,agesp1,agesp2)\nexpectDiff=t(AGE)%*%coefficients(mlr.fit)[5:8]\nV = vcov(mlr.fit)[5:8,5:8]\nV.big = t(AGE)%*%V%*%AGE\nvar = diag(V.big)\ndiffage = data.frame(age,\n          expectDiff = expectDiff/1000,\n          std = sqrt(var),\n          min = (expectDiff-1.96*sqrt(var))/1000,\n          max =(expectDiff+1.96*sqrt(var))/1000)\nggplot(diffage,aes(x = age,y = expectDiff)) +\n    geom_line(data = diffage) +\n    geom_hline(yintercept = 0,col = 'blue',data= diffage, linetype = \"dashed\") +\n    geom_ribbon(aes(ymin=min,ymax =max),alpha =0.5,data= diffage) +\n    scale_y_continuous(breaks=seq(-3,12,1),limits=c(-3,12)) +\n    scale_x_continuous(breaks=seq(65,95,5),limits=c(65,95)) +\n    labs(y = \"Difference (Female - Male, in $1000s)\", x = \"Age (in years)\") +\n    theme_bw() \n\n\n\n\n\nFigure 5: Expected difference between women and men in medical expenditures as a function of age. The dotted line indicates no difference. 95% confidence interval is illustrated in the shaded region.\n\n\n\n\n\n\nStep 3: linear regression model with age\nFurther, we want to test the null hypothesis that on average, males and females use the same quantity of medical services; i.e. are the mean expenditures at any age the same for males and females?\n\\[\n\\begin{align*}\nH_0: & \\ \\beta_4 = \\beta_5 = \\beta_6 = \\beta_7 = 0 \\\\\nH_a: & \\ \\text{at least one of } \\beta_4, \\beta_5, \\beta_6, \\text{ or } \\beta_7 \\text{ is not zero.}\n\\end{align*}\n\\]\nWe can fit a reduced a model with only age-related predictors:\n\\[\n\\begin{align*}\nY_i = & \\ \\beta_0 + \\beta_1(age_i-65) + \\beta_2(age_i-75)^+ + \\beta_3(age_i-85)^+ + \\epsilon_i \\text{ , } \\\\\n      & \\ \\text{where } \\epsilon_i \\sim N(0, \\sigma^2)\n\\end{align*}\n\\]\n\n\nCode\nmlr.fit0 &lt;- lm(totalexp ~ agem65 + age_sp1 + age_sp2, data = d)\n\ntidy_mlr.fit0 &lt;- tidy(mlr.fit0)\ntidy_mlr.fit0 &lt;- tidy_mlr.fit0[, c(\"term\", \"estimate\", \"std.error\", \"statistic\", \"p.value\")]\n\nkable(tidy_mlr.fit0, caption = \"Linear model coefficients of the reduced model\", digits = 3, format = \"html\", \n      col.names = c(\"Term\", \"Estimate\", \"Std. Error\", \"t value\", \"Pr(&gt;|t|)\")) %&gt;%\n  kable_styling(bootstrap_options = c(\"striped\", \"hover\"), full_width = F, position = \"left\")\n\n\n\nLinear model coefficients of the reduced model\n\n\nTerm\nEstimate\nStd. Error\nt value\nPr(&gt;|t|)\n\n\n\n\n(Intercept)\n3582.732\n301.979\n11.864\n0.000\n\n\nagem65\n81.695\n48.169\n1.696\n0.090\n\n\nage_sp1\n40.248\n95.995\n0.419\n0.675\n\n\nage_sp2\n85.352\n193.851\n0.440\n0.660\n\n\n\n\n\n\n\n\n\nCode\n# likelihood ratio test\nlibrary(lmtest)\nlrtest(mlr.fit0, mlr.fit)\n\n\nLikelihood ratio test\n\nModel 1: totalexp ~ agem65 + age_sp1 + age_sp2\nModel 2: totalexp ~ (agem65 + age_sp1 + age_sp2) + Gender + Gender * (agem65 + \n    age_sp1 + age_sp2)\n  #Df LogLik Df Chisq Pr(&gt;Chisq)\n1   5 -60831                    \n2   9 -60828  4 5.158     0.2715\n\n\nA likelihood ratio test showed that the reduced model and the full model are not significantly different from each other (\\(p=0.2715\\)), indicating we fail to reject the null hypothesis and that the mean expenditures at any age are the same for males and females.\n\n\n\nResults and Summary\nIn this example analysis, we utilized the data from 1987 National Medical Expenditure Survey (NMES) to examine the annual change of total medical expenditure for older people (from age 65 to 94) and its relationship with sex. We first fitted a linear spline regression model on total medical expenditure with age and sex and the interaction between the two factors. The regression result showed that none of the predictors of age and sex were significant except for the intercept, even though the scatter plot indicated some disparity between male and female at age 65 - 75 and above 85 (Figure 4). The 95% confidence interval for estimated difference in average expenditures comparing men and women as a function of age suggested no significant difference due to sex (Figure 5). We performed a likelihood ratio test to compare the full model with a reduced model excluding the factor sex and concluded that we failed to reject the null hypothesis that men and women have the same quantity of medical expenditures at any age.\n\n\n\n\n\n\nImportant\n\n\n\n\n\nThis analysis is based on the assumption that residuals are normally distributed and homoscedastic, which requires further validation. If such assumptions are violated, standard errors and confidence intervals are likely biased, and a more appropriate analysis approach need to be adapted.\n\n\n\nHowever, more recent analyses indeed demonstrated noticeable discrepancy between female and male in healthcare expenses. The Kaiser Family Foundation analysis of CMS Medicare Current Beneficiary Survey 2009 Cost and Use file (Medicare’s Role for Older Women 2019) showed that out-of-pocket spending by elder female is higher than that by male while more proportion of women had annual incomes below $20,000 compared to men (Figure 6). Thus, it is important for health policymakers to consider various factors regarding medical expenditures, such as socioeconomic status and etc., before coming to any conclusions.\n\n\n\nFigure 6: Income and out-of-pocket expenses among older medicare beneficiaries, by gender and age\n\n\n\n\nFunctions\n\ndplyr: select(), filter(), mutate(), group_by(),summarise()\nggplot2: geom_point(), geom_jitter, geom_line, geom_hline, geom_ribbon\n\n\n\n\n\n\n\n\n\n\n\nReferences\n\nClosing the Benefit Gap to Advance Women’s Health Equity. 2023. Deloitte United States. https://www2.deloitte.com/us/en/pages/life-sciences-and-health-care/articles/womens-health-equity-disparities.html?utm_source=newsletter&utm_medium=email&utm_campaign=newsletter_axiosvitals&stream=top.\n\n\nMedicare’s Role for Older Women. 2019. KFF. https://www.kff.org/womens-health-policy/fact-sheet/medicares-role-for-older-women/.\n\n\nScientific Data NMES. 2016. Centers for Disease Control and Prevention. https://wonder.cdc.gov/wonder/sci_data/surveys/nmes/nmes.asp."
  }
]